<div class="d-flex justify-content-between align-items-center mx-3 mt-2 p-1 save-bar">
  <i (click)="back()" class="bi bi-chevron-left fw-bolder fs-4 text-dark back-arrow"></i>
  <button class="me-4 w-10 save-btn" (click)="submit()" [disabled]="isBusy">
    {{ isBusy ? 'Saving...' : isEdit ? 'Update Campaign' : 'Create Campaign' }}
  </button>
</div>

<div class="card p-4 m-4 shadow custom-card pb-5">
  <label><strong>Campaign Title <span class="text-danger">*</span></strong></label>
  <input type="text" [(ngModel)]="campaign.campaign_title" #campaignTitleCtrl="ngModel"
    (ngModelChange)="changeValidity('campaign_title')" class="form-control mb-2"
    [class.is-invalid]="!isFieldsValid.campaign_title && clickOnSave" placeholder="Enter Campaign Title" />
  <div *ngIf="!isFieldsValid.campaign_title && clickOnSave" class="invalid-feedback d-block">
    Campaign title is required.
  </div>

  <label><strong>Campaign Type <span class="text-danger">*</span></strong></label>
  <select [(ngModel)]="campaign.type" #typeCtrl="ngModel" (ngModelChange)="onTypeChange(); changeValidity('type')"
    class="form-select mb-2" [class.is-invalid]="!isFieldsValid.type && clickOnSave">
    <option value="" disabled>Select type</option>
    <option value="Product">Products</option>
    <option value="Marketing">Marketing</option>
  </select>
  <div *ngIf="!isFieldsValid.type && clickOnSave" class="invalid-feedback d-block">
    Campaign type is required.

  </div>

  <div *ngIf="campaign.type === 'Product'">
    <label><strong>Select Product <span class="text-danger">*</span></strong></label>
    <select [(ngModel)]="campaign.products_id" #productCtrl="ngModel" (ngModelChange)="changeValidity('products_id')"
      class="form-select mb-2" [class.is-invalid]="!isFieldsValid.products_id && clickOnSave">
      <option [ngValue]="null" disabled>Select Product</option>
      <option *ngFor="let product of productsList" [value]="product.products_id">
        {{ product.title }}
      </option>
    </select>
    <div *ngIf="!isFieldsValid.products_id && clickOnSave" class="invalid-feedback d-block">
      Please select a product.
    </div>
  </div>

  <div *ngIf="campaign.type === 'Marketing'">
    <label><strong>Select Marketing Message <span class="text-danger">*</span></strong></label>
    <select [(ngModel)]="campaign.pushmessages_id" #marketingCtrl="ngModel"
      (ngModelChange)="changeValidity('pushmessages_id')" class="form-select mb-2"
      [class.is-invalid]="!isFieldsValid.pushmessages_id && clickOnSave">
      <option [ngValue]="null" disabled>Select Message</option>
      <option *ngFor="let msg of marketingList" [value]="msg.pushmessages_id">
        {{ msg.title }}
      </option>
    </select>
    <div *ngIf="!isFieldsValid.pushmessages_id && clickOnSave" class="invalid-feedback d-block">
      Please select a marketing message.
    </div>
  </div>

  <div class="row">
    <div class="col-6">
      <label><strong>Start Date <span class="text-danger">*</span></strong></label>
      <input type="date" [(ngModel)]="campaign.start_date" #startDateCtrl="ngModel"
        (ngModelChange)="changeValidity('start_date')" class="form-control"
        [class.is-invalid]="!isFieldsValid.start_date && clickOnSave" />
      <div *ngIf="!isFieldsValid.start_date && clickOnSave" class="invalid-feedback d-block">
        Start date is required.
      </div>
    </div>

    <div class="col-6">
      <label><strong>End Date <span class="text-danger">*</span></strong></label>
      <input type="date" [(ngModel)]="campaign.end_date" #endDateCtrl="ngModel"
        (ngModelChange)="changeValidity('end_date')" class="form-control"
        [class.is-invalid]="!isFieldsValid.end_date && clickOnSave" />
      <div *ngIf="!isFieldsValid.end_date && clickOnSave" class="invalid-feedback d-block">
        End date is required.
      </div>
    </div>
  </div>
</div>
